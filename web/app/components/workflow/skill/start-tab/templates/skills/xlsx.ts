// AUTO-GENERATED — DO NOT EDIT
// Source: https://github.com/anthropics/skills
import type { SkillTemplateNode } from '../types'

const children: SkillTemplateNode[] = [
  {
    "name": "SKILL.md",
    "node_type": "file",
    "content": "---\nname: xlsx\ndescription: \"Comprehensive spreadsheet creation, editing, and analysis with support for formulas, formatting, data analysis, and visualization. When Claude needs to work with spreadsheets (.xlsx, .xlsm, .csv, .tsv, etc) for: (1) Creating new spreadsheets with formulas and formatting, (2) Reading or analyzing data, (3) Modify existing spreadsheets while preserving formulas, (4) Data analysis and visualization in spreadsheets, or (5) Recalculating formulas\"\nlicense: Proprietary. LICENSE.txt has complete terms\n---\n\n# Requirements for Outputs\n\n## All Excel files\n\n### Zero Formula Errors\n- Every Excel model MUST be delivered with ZERO formula errors (#REF!, #DIV/0!, #VALUE!, #N/A, #NAME?)\n\n### Preserve Existing Templates (when updating templates)\n- Study and EXACTLY match existing format, style, and conventions when modifying files\n- Never impose standardized formatting on files with established patterns\n- Existing template conventions ALWAYS override these guidelines\n\n## Financial models\n\n### Color Coding Standards\nUnless otherwise stated by the user or existing template\n\n#### Industry-Standard Color Conventions\n- **Blue text (RGB: 0,0,255)**: Hardcoded inputs, and numbers users will change for scenarios\n- **Black text (RGB: 0,0,0)**: ALL formulas and calculations\n- **Green text (RGB: 0,128,0)**: Links pulling from other worksheets within same workbook\n- **Red text (RGB: 255,0,0)**: External links to other files\n- **Yellow background (RGB: 255,255,0)**: Key assumptions needing attention or cells that need to be updated\n\n### Number Formatting Standards\n\n#### Required Format Rules\n- **Years**: Format as text strings (e.g., \"2024\" not \"2,024\")\n- **Currency**: Use $#,##0 format; ALWAYS specify units in headers (\"Revenue ($mm)\")\n- **Zeros**: Use number formatting to make all zeros \"-\", including percentages (e.g., \"$#,##0;($#,##0);-\")\n- **Percentages**: Default to 0.0% format (one decimal)\n- **Multiples**: Format as 0.0x for valuation multiples (EV/EBITDA, P/E)\n- **Negative numbers**: Use parentheses (123) not minus -123\n\n### Formula Construction Rules\n\n#### Assumptions Placement\n- Place ALL assumptions (growth rates, margins, multiples, etc.) in separate assumption cells\n- Use cell references instead of hardcoded values in formulas\n- Example: Use =B5*(1+$B$6) instead of =B5*1.05\n\n#### Formula Error Prevention\n- Verify all cell references are correct\n- Check for off-by-one errors in ranges\n- Ensure consistent formulas across all projection periods\n- Test with edge cases (zero values, negative numbers)\n- Verify no unintended circular references\n\n#### Documentation Requirements for Hardcodes\n- Comment or in cells beside (if end of table). Format: \"Source: [System/Document], [Date], [Specific Reference], [URL if applicable]\"\n- Examples:\n  - \"Source: Company 10-K, FY2024, Page 45, Revenue Note, [SEC EDGAR URL]\"\n  - \"Source: Company 10-Q, Q2 2025, Exhibit 99.1, [SEC EDGAR URL]\"\n  - \"Source: Bloomberg Terminal, 8/15/2025, AAPL US Equity\"\n  - \"Source: FactSet, 8/20/2025, Consensus Estimates Screen\"\n\n# XLSX creation, editing, and analysis\n\n## Overview\n\nA user may ask you to create, edit, or analyze the contents of an .xlsx file. You have different tools and workflows available for different tasks.\n\n## Important Requirements\n\n**LibreOffice Required for Formula Recalculation**: You can assume LibreOffice is installed for recalculating formula values using the `recalc.py` script. The script automatically configures LibreOffice on first run\n\n## Reading and analyzing data\n\n### Data analysis with pandas\nFor data analysis, visualization, and basic operations, use **pandas** which provides powerful data manipulation capabilities:\n\n```python\nimport pandas as pd\n\n# Read Excel\ndf = pd.read_excel('file.xlsx')  # Default: first sheet\nall_sheets = pd.read_excel('file.xlsx', sheet_name=None)  # All sheets as dict\n\n# Analyze\ndf.head()      # Preview data\ndf.info()      # Column info\ndf.describe()  # Statistics\n\n# Write Excel\ndf.to_excel('output.xlsx', index=False)\n```\n\n## Excel File Workflows\n\n## CRITICAL: Use Formulas, Not Hardcoded Values\n\n**Always use Excel formulas instead of calculating values in Python and hardcoding them.** This ensures the spreadsheet remains dynamic and updateable.\n\n### ❌ WRONG - Hardcoding Calculated Values\n```python\n# Bad: Calculating in Python and hardcoding result\ntotal = df['Sales'].sum()\nsheet['B10'] = total  # Hardcodes 5000\n\n# Bad: Computing growth rate in Python\ngrowth = (df.iloc[-1]['Revenue'] - df.iloc[0]['Revenue']) / df.iloc[0]['Revenue']\nsheet['C5'] = growth  # Hardcodes 0.15\n\n# Bad: Python calculation for average\navg = sum(values) / len(values)\nsheet['D20'] = avg  # Hardcodes 42.5\n```\n\n### ✅ CORRECT - Using Excel Formulas\n```python\n# Good: Let Excel calculate the sum\nsheet['B10'] = '=SUM(B2:B9)'\n\n# Good: Growth rate as Excel formula\nsheet['C5'] = '=(C4-C2)/C2'\n\n# Good: Average using Excel function\nsheet['D20'] = '=AVERAGE(D2:D19)'\n```\n\nThis applies to ALL calculations - totals, percentages, ratios, differences, etc. The spreadsheet should be able to recalculate when source data changes.\n\n## Common Workflow\n1. **Choose tool**: pandas for data, openpyxl for formulas/formatting\n2. **Create/Load**: Create new workbook or load existing file\n3. **Modify**: Add/edit data, formulas, and formatting\n4. **Save**: Write to file\n5. **Recalculate formulas (MANDATORY IF USING FORMULAS)**: Use the recalc.py script\n   ```bash\n   python recalc.py output.xlsx\n   ```\n6. **Verify and fix any errors**: \n   - The script returns JSON with error details\n   - If `status` is `errors_found`, check `error_summary` for specific error types and locations\n   - Fix the identified errors and recalculate again\n   - Common errors to fix:\n     - `#REF!`: Invalid cell references\n     - `#DIV/0!`: Division by zero\n     - `#VALUE!`: Wrong data type in formula\n     - `#NAME?`: Unrecognized formula name\n\n### Creating new Excel files\n\n```python\n# Using openpyxl for formulas and formatting\nfrom openpyxl import Workbook\nfrom openpyxl.styles import Font, PatternFill, Alignment\n\nwb = Workbook()\nsheet = wb.active\n\n# Add data\nsheet['A1'] = 'Hello'\nsheet['B1'] = 'World'\nsheet.append(['Row', 'of', 'data'])\n\n# Add formula\nsheet['B2'] = '=SUM(A1:A10)'\n\n# Formatting\nsheet['A1'].font = Font(bold=True, color='FF0000')\nsheet['A1'].fill = PatternFill('solid', start_color='FFFF00')\nsheet['A1'].alignment = Alignment(horizontal='center')\n\n# Column width\nsheet.column_dimensions['A'].width = 20\n\nwb.save('output.xlsx')\n```\n\n### Editing existing Excel files\n\n```python\n# Using openpyxl to preserve formulas and formatting\nfrom openpyxl import load_workbook\n\n# Load existing file\nwb = load_workbook('existing.xlsx')\nsheet = wb.active  # or wb['SheetName'] for specific sheet\n\n# Working with multiple sheets\nfor sheet_name in wb.sheetnames:\n    sheet = wb[sheet_name]\n    print(f\"Sheet: {sheet_name}\")\n\n# Modify cells\nsheet['A1'] = 'New Value'\nsheet.insert_rows(2)  # Insert row at position 2\nsheet.delete_cols(3)  # Delete column 3\n\n# Add new sheet\nnew_sheet = wb.create_sheet('NewSheet')\nnew_sheet['A1'] = 'Data'\n\nwb.save('modified.xlsx')\n```\n\n## Recalculating formulas\n\nExcel files created or modified by openpyxl contain formulas as strings but not calculated values. Use the provided `recalc.py` script to recalculate formulas:\n\n```bash\npython recalc.py <excel_file> [timeout_seconds]\n```\n\nExample:\n```bash\npython recalc.py output.xlsx 30\n```\n\nThe script:\n- Automatically sets up LibreOffice macro on first run\n- Recalculates all formulas in all sheets\n- Scans ALL cells for Excel errors (#REF!, #DIV/0!, etc.)\n- Returns JSON with detailed error locations and counts\n- Works on both Linux and macOS\n\n## Formula Verification Checklist\n\nQuick checks to ensure formulas work correctly:\n\n### Essential Verification\n- [ ] **Test 2-3 sample references**: Verify they pull correct values before building full model\n- [ ] **Column mapping**: Confirm Excel columns match (e.g., column 64 = BL, not BK)\n- [ ] **Row offset**: Remember Excel rows are 1-indexed (DataFrame row 5 = Excel row 6)\n\n### Common Pitfalls\n- [ ] **NaN handling**: Check for null values with `pd.notna()`\n- [ ] **Far-right columns**: FY data often in columns 50+ \n- [ ] **Multiple matches**: Search all occurrences, not just first\n- [ ] **Division by zero**: Check denominators before using `/` in formulas (#DIV/0!)\n- [ ] **Wrong references**: Verify all cell references point to intended cells (#REF!)\n- [ ] **Cross-sheet references**: Use correct format (Sheet1!A1) for linking sheets\n\n### Formula Testing Strategy\n- [ ] **Start small**: Test formulas on 2-3 cells before applying broadly\n- [ ] **Verify dependencies**: Check all cells referenced in formulas exist\n- [ ] **Test edge cases**: Include zero, negative, and very large values\n\n### Interpreting recalc.py Output\nThe script returns JSON with error details:\n```json\n{\n  \"status\": \"success\",           // or \"errors_found\"\n  \"total_errors\": 0,              // Total error count\n  \"total_formulas\": 42,           // Number of formulas in file\n  \"error_summary\": {              // Only present if errors found\n    \"#REF!\": {\n      \"count\": 2,\n      \"locations\": [\"Sheet1!B5\", \"Sheet1!C10\"]\n    }\n  }\n}\n```\n\n## Best Practices\n\n### Library Selection\n- **pandas**: Best for data analysis, bulk operations, and simple data export\n- **openpyxl**: Best for complex formatting, formulas, and Excel-specific features\n\n### Working with openpyxl\n- Cell indices are 1-based (row=1, column=1 refers to cell A1)\n- Use `data_only=True` to read calculated values: `load_workbook('file.xlsx', data_only=True)`\n- **Warning**: If opened with `data_only=True` and saved, formulas are replaced with values and permanently lost\n- For large files: Use `read_only=True` for reading or `write_only=True` for writing\n- Formulas are preserved but not evaluated - use recalc.py to update values\n\n### Working with pandas\n- Specify data types to avoid inference issues: `pd.read_excel('file.xlsx', dtype={'id': str})`\n- For large files, read specific columns: `pd.read_excel('file.xlsx', usecols=['A', 'C', 'E'])`\n- Handle dates properly: `pd.read_excel('file.xlsx', parse_dates=['date_column'])`\n\n## Code Style Guidelines\n**IMPORTANT**: When generating Python code for Excel operations:\n- Write minimal, concise Python code without unnecessary comments\n- Avoid verbose variable names and redundant operations\n- Avoid unnecessary print statements\n\n**For Excel files themselves**:\n- Add comments to cells with complex formulas or important assumptions\n- Document data sources for hardcoded values\n- Include notes for key calculations and model sections"
  },
  {
    "name": "recalc.py",
    "node_type": "file",
    "content": "#!/usr/bin/env python3\n\"\"\"\nExcel Formula Recalculation Script\nRecalculates all formulas in an Excel file using LibreOffice\n\"\"\"\n\nimport json\nimport sys\nimport subprocess\nimport os\nimport platform\nfrom pathlib import Path\nfrom openpyxl import load_workbook\n\n\ndef setup_libreoffice_macro():\n    \"\"\"Setup LibreOffice macro for recalculation if not already configured\"\"\"\n    if platform.system() == 'Darwin':\n        macro_dir = os.path.expanduser('~/Library/Application Support/LibreOffice/4/user/basic/Standard')\n    else:\n        macro_dir = os.path.expanduser('~/.config/libreoffice/4/user/basic/Standard')\n    \n    macro_file = os.path.join(macro_dir, 'Module1.xba')\n    \n    if os.path.exists(macro_file):\n        with open(macro_file, 'r') as f:\n            if 'RecalculateAndSave' in f.read():\n                return True\n    \n    if not os.path.exists(macro_dir):\n        subprocess.run(['soffice', '--headless', '--terminate_after_init'], \n                      capture_output=True, timeout=10)\n        os.makedirs(macro_dir, exist_ok=True)\n    \n    macro_content = '''<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE script:module PUBLIC \"-//OpenOffice.org//DTD OfficeDocument 1.0//EN\" \"module.dtd\">\n<script:module xmlns:script=\"http://openoffice.org/2000/script\" script:name=\"Module1\" script:language=\"StarBasic\">\n    Sub RecalculateAndSave()\n      ThisComponent.calculateAll()\n      ThisComponent.store()\n      ThisComponent.close(True)\n    End Sub\n</script:module>'''\n    \n    try:\n        with open(macro_file, 'w') as f:\n            f.write(macro_content)\n        return True\n    except Exception:\n        return False\n\n\ndef recalc(filename, timeout=30):\n    \"\"\"\n    Recalculate formulas in Excel file and report any errors\n    \n    Args:\n        filename: Path to Excel file\n        timeout: Maximum time to wait for recalculation (seconds)\n    \n    Returns:\n        dict with error locations and counts\n    \"\"\"\n    if not Path(filename).exists():\n        return {'error': f'File {filename} does not exist'}\n    \n    abs_path = str(Path(filename).absolute())\n    \n    if not setup_libreoffice_macro():\n        return {'error': 'Failed to setup LibreOffice macro'}\n    \n    cmd = [\n        'soffice', '--headless', '--norestore',\n        'vnd.sun.star.script:Standard.Module1.RecalculateAndSave?language=Basic&location=application',\n        abs_path\n    ]\n    \n    # Handle timeout command differences between Linux and macOS\n    if platform.system() != 'Windows':\n        timeout_cmd = 'timeout' if platform.system() == 'Linux' else None\n        if platform.system() == 'Darwin':\n            # Check if gtimeout is available on macOS\n            try:\n                subprocess.run(['gtimeout', '--version'], capture_output=True, timeout=1, check=False)\n                timeout_cmd = 'gtimeout'\n            except (FileNotFoundError, subprocess.TimeoutExpired):\n                pass\n        \n        if timeout_cmd:\n            cmd = [timeout_cmd, str(timeout)] + cmd\n    \n    result = subprocess.run(cmd, capture_output=True, text=True)\n    \n    if result.returncode != 0 and result.returncode != 124:  # 124 is timeout exit code\n        error_msg = result.stderr or 'Unknown error during recalculation'\n        if 'Module1' in error_msg or 'RecalculateAndSave' not in error_msg:\n            return {'error': 'LibreOffice macro not configured properly'}\n        else:\n            return {'error': error_msg}\n    \n    # Check for Excel errors in the recalculated file - scan ALL cells\n    try:\n        wb = load_workbook(filename, data_only=True)\n        \n        excel_errors = ['#VALUE!', '#DIV/0!', '#REF!', '#NAME?', '#NULL!', '#NUM!', '#N/A']\n        error_details = {err: [] for err in excel_errors}\n        total_errors = 0\n        \n        for sheet_name in wb.sheetnames:\n            ws = wb[sheet_name]\n            # Check ALL rows and columns - no limits\n            for row in ws.iter_rows():\n                for cell in row:\n                    if cell.value is not None and isinstance(cell.value, str):\n                        for err in excel_errors:\n                            if err in cell.value:\n                                location = f\"{sheet_name}!{cell.coordinate}\"\n                                error_details[err].append(location)\n                                total_errors += 1\n                                break\n        \n        wb.close()\n        \n        # Build result summary\n        result = {\n            'status': 'success' if total_errors == 0 else 'errors_found',\n            'total_errors': total_errors,\n            'error_summary': {}\n        }\n        \n        # Add non-empty error categories\n        for err_type, locations in error_details.items():\n            if locations:\n                result['error_summary'][err_type] = {\n                    'count': len(locations),\n                    'locations': locations[:20]  # Show up to 20 locations\n                }\n        \n        # Add formula count for context - also check ALL cells\n        wb_formulas = load_workbook(filename, data_only=False)\n        formula_count = 0\n        for sheet_name in wb_formulas.sheetnames:\n            ws = wb_formulas[sheet_name]\n            for row in ws.iter_rows():\n                for cell in row:\n                    if cell.value and isinstance(cell.value, str) and cell.value.startswith('='):\n                        formula_count += 1\n        wb_formulas.close()\n        \n        result['total_formulas'] = formula_count\n        \n        return result\n        \n    except Exception as e:\n        return {'error': str(e)}\n\n\ndef main():\n    if len(sys.argv) < 2:\n        print(\"Usage: python recalc.py <excel_file> [timeout_seconds]\")\n        print(\"\\nRecalculates all formulas in an Excel file using LibreOffice\")\n        print(\"\\nReturns JSON with error details:\")\n        print(\"  - status: 'success' or 'errors_found'\")\n        print(\"  - total_errors: Total number of Excel errors found\")\n        print(\"  - total_formulas: Number of formulas in the file\")\n        print(\"  - error_summary: Breakdown by error type with locations\")\n        print(\"    - #VALUE!, #DIV/0!, #REF!, #NAME?, #NULL!, #NUM!, #N/A\")\n        sys.exit(1)\n    \n    filename = sys.argv[1]\n    timeout = int(sys.argv[2]) if len(sys.argv) > 2 else 30\n    \n    result = recalc(filename, timeout)\n    print(json.dumps(result, indent=2))\n\n\nif __name__ == '__main__':\n    main()"
  }
]

export default children
