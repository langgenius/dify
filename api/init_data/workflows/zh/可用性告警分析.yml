app:
  description: ''
  icon: ğŸ¤–
  icon_background: '#FFEAD5'
  mode: workflow
  name: å¯ç”¨æ€§å‘Šè­¦åˆ†æ
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: package
  value:
    plugin_unique_identifier: langgenius/openai_api_compatible:0.0.7@f20c7275bbcf055ec5d170dd5128e341986e2dcba5266d08fd080d4bdf2288f6
kind: app
version: 0.1.5
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      allowed_file_types:
      - image
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: false
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        image_file_size_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: ''
    retriever_resource:
      enabled: true
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInIteration: false
        sourceType: template-transform
        targetType: end
      id: 1741592094819-source-1741592144815-target
      selected: false
      source: '1741592094819'
      sourceHandle: source
      target: '1741592144815'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: start
        targetType: code
      id: 1741227526517-source-1742807803325-target
      selected: false
      source: '1741227526517'
      sourceHandle: source
      target: '1742807803325'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: tool
      id: 1744878352649-source-1744878296971-target
      selected: false
      source: '1744878352649'
      sourceHandle: source
      target: '1744878296971'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: tool
        targetType: code
      id: 1744878298576-source-1744878389686-target
      selected: false
      source: '1744878298576'
      sourceHandle: source
      target: '1744878389686'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: code
      id: 1744878389686-source-17448784268890-target
      selected: false
      source: '1744878389686'
      sourceHandle: source
      target: '17448784268890'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: tool
      id: 17448784268890-source-17448784142480-target
      selected: false
      source: '17448784268890'
      sourceHandle: source
      target: '17448784142480'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: tool
        targetType: code
      id: 1744878296971-source-1744901266309-target
      selected: false
      source: '1744878296971'
      sourceHandle: source
      target: '1744901266309'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: llm
      id: 1744901266309-source-1744878372490-target
      selected: false
      source: '1744901266309'
      sourceHandle: source
      target: '1744878372490'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: tool
        targetType: code
      id: 17448784142480-source-17449013347930-target
      selected: false
      source: '17448784142480'
      sourceHandle: source
      target: '17449013347930'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: if-else
      id: 1742807803325-source-1742453019576-target
      selected: false
      source: '1742807803325'
      sourceHandle: source
      target: '1742453019576'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: question-classifier
        targetType: tool
      id: 17430590082510-1744901730034-1744878298576-target
      selected: false
      source: '17430590082510'
      sourceHandle: '1744901730034'
      target: '1744878298576'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: question-classifier
        targetType: code
      id: 17430590082510-1744901735377-1744878352649-target
      selected: false
      source: '17430590082510'
      sourceHandle: '1744901735377'
      target: '1744878352649'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: llm
      id: 17449013347930-source-17448784398000-target
      selected: false
      source: '17449013347930'
      sourceHandle: source
      target: '17448784398000'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: template-transform
        targetType: end
      id: 1745313576757-source-1745313574375-target
      source: '1745313576757'
      sourceHandle: source
      target: '1745313574375'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: template-transform
      id: 1742453019576-true-1741592094819-target
      source: '1742453019576'
      sourceHandle: 'true'
      target: '1741592094819'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: question-classifier
      id: 1742453019576-false-17430590082510-target
      source: '1742453019576'
      sourceHandle: 'false'
      target: '17430590082510'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: question-classifier
        targetType: template-transform
      id: 17430590082510-1745391097407-1745313576757-target
      source: '17430590082510'
      sourceHandle: '1745391097407'
      target: '1745313576757'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: question-classifier
        targetType: llm
      id: 17430590082510-1745391089084-1745391138767-target
      source: '17430590082510'
      sourceHandle: '1745391089084'
      target: '1745391138767'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: llm
        targetType: end
      id: 1745391138767-source-1745391142578-target
      source: '1745391138767'
      sourceHandle: source
      target: '1745391142578'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: tool
      id: 1750839702220-source-1750839691646-target
      source: '1750839702220'
      sourceHandle: source
      target: '1750839691646'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: tool
      id: 1750840042580-source-1750839691646-target
      source: '1750840042580'
      sourceHandle: source
      target: '1750839691646'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: llm
        targetType: code
      id: 1750840340832-source-1750840042580-target
      source: '1750840340832'
      sourceHandle: source
      target: '1750840042580'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: tool
      id: 1750843294839-source-1750839691646-target
      source: '1750843294839'
      sourceHandle: source
      target: '1750839691646'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: tool
      id: 1750843922551-source-1750839691646-target
      source: '1750843922551'
      sourceHandle: source
      target: '1750839691646'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: tool
      id: 1750843945254-source-1750839691646-target
      source: '1750843945254'
      sourceHandle: source
      target: '1750839691646'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: llm
        targetType: variable-aggregator
      id: 17448784398000-source-1750844540721-target
      source: '17448784398000'
      sourceHandle: source
      target: '1750844540721'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: variable-aggregator
        targetType: variable-aggregator
      id: 1750844540721-source-1744878466157-target
      source: '1750844540721'
      sourceHandle: source
      target: '1744878466157'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: llm
        targetType: variable-aggregator
      id: 1744878372490-source-1750844540721-target
      source: '1744878372490'
      sourceHandle: source
      target: '1750844540721'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: llm
        targetType: code
      id: 1750846397041-source-1750843922551-target
      source: '1750846397041'
      sourceHandle: source
      target: '1750843922551'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: llm
        targetType: code
      id: 1750846407202-source-1750843945254-target
      source: '1750846407202'
      sourceHandle: source
      target: '1750843945254'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: tool
      id: 1750941439700-source-1750839691646-target
      source: '1750941439700'
      sourceHandle: source
      target: '1750839691646'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: llm
        targetType: llm
      id: 1750987639392-source-1750840340832-target
      source: '1750987639392'
      sourceHandle: source
      target: '1750840340832'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: llm
        targetType: end
      id: 1751004239868-source-1744878476249-target
      source: '1751004239868'
      sourceHandle: source
      target: '1744878476249'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: llm
        targetType: code
      id: 1751251291730-source-1750843294839-target
      source: '1751251291730'
      sourceHandle: source
      target: '1750843294839'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: tool
        targetType: llm
      id: 1751602453263-source-1751004239868-target
      source: '1751602453263'
      sourceHandle: source
      target: '1751004239868'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: tool
        targetType: tool
      id: 1750839691646-source-1751602453263-target
      source: '1750839691646'
      sourceHandle: source
      target: '1751602453263'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: variable-aggregator
        targetType: if-else
      id: 1744878466157-source-1751602618703-target
      source: '1744878466157'
      sourceHandle: source
      target: '1751602618703'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: code
      id: 1751602618703-false-1750839702220-target
      source: '1751602618703'
      sourceHandle: 'false'
      target: '1750839702220'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: llm
      id: 1751602618703-false-1750987639392-target
      source: '1751602618703'
      sourceHandle: 'false'
      target: '1750987639392'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: llm
      id: 1751602618703-false-1750846397041-target
      source: '1751602618703'
      sourceHandle: 'false'
      target: '1750846397041'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: code
      id: 1751602618703-false-1750941439700-target
      source: '1751602618703'
      sourceHandle: 'false'
      target: '1750941439700'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: llm
      id: 1751602618703-false-1750846407202-target
      source: '1751602618703'
      sourceHandle: 'false'
      target: '1750846407202'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: llm
      id: 1751602618703-false-1751251291730-target
      source: '1751602618703'
      sourceHandle: 'false'
      target: '1751251291730'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: end
      id: 1751602618703-true-1751602687916-target
      source: '1751602618703'
      sourceHandle: 'true'
      target: '1751602687916'
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: ''
        selected: false
        title: start
        type: start
        variables:
        - label: startTime
          max_length: 48
          options: []
          required: true
          type: number
          variable: startTime
        - label: endTime
          max_length: 48
          options: []
          required: true
          type: number
          variable: endTime
        - label: params
          max_length: 9999999
          options: []
          required: false
          type: paragraph
          variable: params
        - label: nodeName
          max_length: null
          options: []
          required: false
          type: paragraph
          variable: nodeName
        - label: edition
          max_length: 48
          options: []
          required: false
          type: paragraph
          variable: edition
      height: 194
      id: '1741227526517'
      position:
        x: 30
        y: 302
      positionAbsolute:
        x: 30
        y: 302
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        selected: false
        template: æœåŠ¡åå’ŒPodå‡ä¸ºç©ºï¼Œæ— æ³•åˆ†ææ ¹å› ã€‚
        title: unsupport alert
        type: template-transform
        variables: []
      height: 54
      id: '1741592094819'
      position:
        x: 942
        y: 302
      positionAbsolute:
        x: 942
        y: 302
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        outputs:
        - value_selector:
          - '1741592094819'
          - output
          variable: output
        selected: false
        title: End
        type: end
      height: 90
      id: '1741592144815'
      position:
        x: 1246
        y: 302
      positionAbsolute:
        x: 1246
        y: 302
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: empty
            id: 22866ae7-2bfa-47e9-9c19-d31e8b63001f
            value: ''
            varType: string
            variable_selector:
            - '1742807803325'
            - pod
          - comparison_operator: empty
            id: add89997-787b-4d71-a187-3e9f8e8f25a3
            value: ''
            varType: string
            variable_selector:
            - '1742807803325'
            - service
          - comparison_operator: empty
            id: 92ba41ac-2567-4509-a249-0a520408d145
            value: ''
            varType: string
            variable_selector:
            - '1742807803325'
            - nodeName
          - comparison_operator: empty
            id: 95786764-d469-4d88-af11-54420e537571
            value: ''
            varType: string
            variable_selector:
            - '1742807803325'
            - containerId
          id: 'true'
          logical_operator: and
        desc: ''
        selected: false
        title: alert instance info
        type: if-else
      height: 204
      id: '1742453019576'
      position:
        x: 638
        y: 302
      positionAbsolute:
        x: 638
        y: 302
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "import json\ndef get_value(data, keys): \n    for key in keys: \n \
          \       value = data.get(key) \n        if value is not None: \n       \
          \     return value \n    return \"\" \n\ndef main(arg: str, node: str) ->\
          \ dict:\n    data = json.loads(arg) \n    detail_str = data.get(\"detail\"\
          , \"\")\n    detail = json.loads(detail_str) if detail_str else {}\n   \
          \ description = detail.get(\"description\", \"\")\n    lines = description.split(\"\
          \\n\")\n    try:\n        labels_line = lines[1]\n        start = labels_line.index(\"\
          [\") + 1\n        end = labels_line.index(\"]\")\n        map_content =\
          \ labels_line[start:end]\n        pairs = map_content.split()\n        labels_dict\
          \ = {pair.split(\":\", 1)[0]: pair.split(\":\", 1)[1] for pair in pairs}\n\
          \        source_from = labels_dict.get(\"source_from\", \"\")\n    except\
          \ (IndexError, ValueError):\n      source_from = \"\"\n\n    return { \n\
          \        \"alertName\": get_value(data, [\"alertname\", \"alertName\", \"\
          alert_name\"]),\n        \"service\": get_value(data, [\"svc_name\", \"\
          service\"]), \n        \"endpoint\": get_value(data, [\"endpoint\", \"content_key\"\
          ]), \n        \"pod\": get_value(data, [\"pod\", \"src_pod\", \"pod_name\"\
          ]), \n        \"namespace\": get_value(data, [\"namespace\", \"src_namespace\"\
          ]),\n        \"pid\": get_value(data, [\"pid\"]),\n        \"containerId\"\
          : get_value(data, [\"containerId\"]),\n        \"nodeName\": node if node\
          \ else get_value(data, [\"node\", \"src_node\", \"node_name\", \"nodeName\"\
          ]),\n        \"sourceFrom\": source_from,\n        \"alertEventId\": get_value(data,\
          \ [\"alertEventId\"]),\n    }"
        code_language: python3
        desc: ''
        outputs:
          alertEventId:
            children: null
            type: string
          alertName:
            children: null
            type: string
          containerId:
            children: null
            type: string
          endpoint:
            children: null
            type: string
          namespace:
            children: null
            type: string
          nodeName:
            children: null
            type: string
          pid:
            children: null
            type: string
          pod:
            children: null
            type: string
          service:
            children: null
            type: string
          sourceFrom:
            children: null
            type: string
        selected: false
        title: get alert event label info
        type: code
        variables:
        - value_selector:
          - '1741227526517'
          - params
          variable: arg
        - value_selector:
          - '1741227526517'
          - nodeName
          variable: node
      height: 54
      id: '1742807803325'
      position:
        x: 334
        y: 302
      positionAbsolute:
        x: 334
        y: 302
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        classes:
        - id: '1744901730034'
          name: è¯·æ±‚é”™è¯¯ç‡
        - id: '1744901735377'
          name: æ—¥å¿—é”™è¯¯ç‡
        - id: '1745391089084'
          name: 'äº‹ä»¶ç±»å‹

            container was killed'
        - id: '1745391097407'
          name: å…¶ä»–
        desc: ''
        instruction: ä½ æ˜¯ä¸€ä¸ªæ™ºèƒ½å‘Šè­¦åˆ†ç±»åŠ©æ‰‹ã€‚ä½ çš„ä»»åŠ¡æ˜¯å¯¹ç»™å®šçš„è­¦æŠ¥äº‹ä»¶è¿›è¡Œåˆ†ç±»ã€‚
        instructions: ''
        isInIteration: true
        iteration_id: '1741497176064'
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: /models/qwen2.5-32B
          provider: langgenius/openai_api_compatible/openai_api_compatible
        query_variable_selector:
        - '1742807803325'
        - alertName
        selected: false
        title: alert event cls
        topics: []
        type: question-classifier
        vision:
          enabled: false
      height: 246
      id: '17430590082510'
      position:
        x: 942
        y: 396
      positionAbsolute:
        x: 942
        y: 396
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
      zIndex: 1002
    - data:
        desc: ''
        is_team_authorization: true
        output_schema: null
        paramSchemas:
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: Query condition(clickhouse where clause).
            ja_JP: Query condition(clickhouse where clause).
            pt_BR: Query condition(clickhouse where clause).
            zh_Hans: æŸ¥è¯¢æ¡ä»¶ï¼ˆclickhouse whereå­å¥ï¼‰
          label:
            en_US: Query condition(clickhouse where clause).
            ja_JP: Query condition(clickhouse where clause).
            pt_BR: Query condition(clickhouse where clause).
            zh_Hans: æŸ¥è¯¢æ¡ä»¶ï¼ˆclickhouse whereå­å¥ï¼‰
          llm_description: Query condition(clickhouse where clause).
          max: null
          min: null
          name: query
          options: []
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: Start timestamp in microseconds
            ja_JP: Start timestamp in microseconds
            pt_BR: Start timestamp in microseconds
            zh_Hans: æŸ¥è¯¢å¼€å§‹æ—¶é—´ï¼ˆå¾®ç§’ï¼‰
          label:
            en_US: Start Time
            ja_JP: Start Time
            pt_BR: Start Time
            zh_Hans: å¼€å§‹æ—¶é—´
          llm_description: Microsecond timestamp for start time
          max: null
          min: null
          name: startTime
          options: []
          placeholder: null
          precision: null
          required: true
          scope: null
          template: null
          type: number
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: End timestamp in microseconds
            ja_JP: End timestamp in microseconds
            pt_BR: End timestamp in microseconds
            zh_Hans: æŸ¥è¯¢ç»“æŸæ—¶é—´ï¼ˆå¾®ç§’ï¼‰
          label:
            en_US: End Time
            ja_JP: End Time
            pt_BR: End Time
            zh_Hans: ç»“æŸæ—¶é—´
          llm_description: Microsecond timestamp for end time
          max: null
          min: null
          name: endTime
          options: []
          placeholder: null
          precision: null
          required: true
          scope: null
          template: null
          type: number
        params:
          endTime: ''
          query: ''
          startTime: ''
        provider_id: apo_select
        provider_name: apo_select
        provider_type: builtin
        selected: false
        title: æŸ¥è¯¢å…¨é‡æ—¥å¿—
        tool_configurations: {}
        tool_label: æŸ¥è¯¢å…¨é‡æ—¥å¿—
        tool_name: æŸ¥è¯¢å…¨é‡æ—¥å¿—
        tool_parameters:
          endTime:
            type: variable
            value:
            - '1741227526517'
            - endTime
          pageNum:
            type: constant
            value: 1
          pageSize:
            type: constant
            value: 999
          query:
            type: mixed
            value: '{{#1744878352649.query#}}'
          startTime:
            type: variable
            value:
            - '1741227526517'
            - startTime
        type: tool
      height: 54
      id: '1744878296971'
      position:
        x: 2158
        y: 812
      positionAbsolute:
        x: 2158
        y: 812
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        is_team_authorization: true
        output_schema: null
        paramSchemas:
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: service name
            ja_JP: service name
            pt_BR: service name
            zh_Hans: æœåŠ¡å
          label:
            en_US: service
            ja_JP: service
            pt_BR: service
            zh_Hans: service
          llm_description: service name
          max: null
          min: null
          name: service
          options: []
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: namespace
            ja_JP: namespace
            pt_BR: namespace
            zh_Hans: å‘½åç©ºé—´
          label:
            en_US: namespace
            ja_JP: namespace
            pt_BR: namespace
            zh_Hans: namespace
          llm_description: namespace
          max: null
          min: null
          name: namespace
          options: []
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: endpoint name
            ja_JP: endpoint name
            pt_BR: endpoint name
            zh_Hans: æœåŠ¡ç«¯ç‚¹
          label:
            en_US: endpoint
            ja_JP: endpoint
            pt_BR: endpoint
            zh_Hans: endpoint
          llm_description: endpoint name
          max: null
          min: null
          name: endpoint
          options: []
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: instance name
            ja_JP: instance name
            pt_BR: instance name
            zh_Hans: å®ä¾‹å
          label:
            en_US: instance
            ja_JP: instance
            pt_BR: instance
            zh_Hans: instance
          llm_description: instance name
          max: null
          min: null
          name: instance
          options: []
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: node name
            ja_JP: node name
            pt_BR: node name
            zh_Hans: æœåŠ¡ç«¯ç‚¹
          label:
            en_US: nodeName
            ja_JP: nodeName
            pt_BR: nodeName
            zh_Hans: ä¸»æœºå
          llm_description: node name
          max: null
          min: null
          name: nodeName
          options: []
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: containerId
            ja_JP: containerId
            pt_BR: containerId
            zh_Hans: æœåŠ¡ç«¯ç‚¹
          label:
            en_US: containerId
            ja_JP: containerId
            pt_BR: containerId
            zh_Hans: å®¹å™¨id
          llm_description: node name
          max: null
          min: null
          name: containerId
          options: []
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: process id
            ja_JP: process id
            pt_BR: process id
            zh_Hans: è¿›ç¨‹id
          label:
            en_US: pid
            ja_JP: pid
            pt_BR: pid
            zh_Hans: è¿›ç¨‹id
          llm_description: process id
          max: null
          min: null
          name: pid
          options: []
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: trace id
            ja_JP: trace id
            pt_BR: trace id
            zh_Hans: trace id
          label:
            en_US: traceId
            ja_JP: traceId
            pt_BR: traceId
            zh_Hans: traceId
          llm_description: trace id
          max: null
          min: null
          name: traceId
          options: []
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: page number
            ja_JP: page number
            pt_BR: page number
            zh_Hans: é¡µç 
          label:
            en_US: pageNum
            ja_JP: pageNum
            pt_BR: pageNum
            zh_Hans: é¡µç 
          llm_description: page number
          max: null
          min: null
          name: pageNum
          options: []
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: number
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: page size
            ja_JP: page size
            pt_BR: page size
            zh_Hans: æ¯é¡µæ¡æ•°
          label:
            en_US: pageSize
            ja_JP: pageSize
            pt_BR: pageSize
            zh_Hans: æ¯é¡µæ¡æ•°
          llm_description: page size
          max: null
          min: null
          name: pageSize
          options: []
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: number
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: Data query start time(Microsecond)
            ja_JP: Data query start time(Microsecond)
            pt_BR: Data query start time(Microsecond)
            zh_Hans: å¼€å§‹æ—¶é—´ (å¾®ç§’)
          label:
            en_US: startTime
            ja_JP: startTime
            pt_BR: startTime
            zh_Hans: startTime
          llm_description: Data query start time(Microsecond)
          max: null
          min: null
          name: startTime
          options: []
          placeholder: null
          precision: null
          required: true
          scope: null
          template: null
          type: number
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: Data query end time(Microsecond)
            ja_JP: Data query end time(Microsecond)
            pt_BR: Data query end time(Microsecond)
            zh_Hans: ç»“æŸæ—¶é—´ (å¾®ç§’)
          label:
            en_US: endTime
            ja_JP: endTime
            pt_BR: endTime
            zh_Hans: endTime
          llm_description: Data query end time(Microsecond)
          max: null
          min: null
          name: endTime
          options: []
          placeholder: null
          precision: null
          required: true
          scope: null
          template: null
          type: number
        params:
          containerId: ''
          endTime: ''
          endpoint: ''
          instance: ''
          namespace: ''
          nodeName: ''
          pageNum: ''
          pageSize: ''
          pid: ''
          service: ''
          startTime: ''
          traceId: ''
        provider_id: apo_select
        provider_name: apo_select
        provider_type: builtin
        selected: false
        title: æŸ¥è¯¢é“¾è·¯æ•°æ®
        tool_configurations: {}
        tool_label: æŸ¥è¯¢é“¾è·¯æ•°æ®
        tool_name: æŸ¥è¯¢é“¾è·¯æ•°æ®
        tool_parameters:
          endTime:
            type: variable
            value:
            - '1741227526517'
            - endTime
          instance:
            type: mixed
            value: '{{#1742807803325.pod#}}'
          namespace:
            type: mixed
            value: ''
          nodeName:
            type: mixed
            value: '{{#1741227526517.nodeName#}}'
          pageNum:
            type: constant
            value: 1
          pageSize:
            type: constant
            value: 100
          service:
            type: mixed
            value: '{{#1742807803325.service#}}'
          startTime:
            type: variable
            value:
            - '1741227526517'
            - startTime
        type: tool
      height: 54
      id: '1744878298576'
      position:
        x: 1246
        y: 510
      positionAbsolute:
        x: 1246
        y: 510
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "\ndef main(pod: str, service: str, node: str, pid: str, containerId:\
          \ str, sourceFrom: str) -> dict:\n    query = ''\n    if len(containerId)\
          \ > 0 and len(node) > 0:\n        query = f\"\"\"container_id='{containerId}'\
          \ and host_name='{node}'\"\"\"\n    elif len(pod) > 0 and len(service) >\
          \ 0:\n        query = f\"\"\"k8s_pod_name='{pod}' and container_name='{service}'\"\
          \"\"\n    elif len(pod) > 0:\n        query = f\"\"\"k8s_pod_name='{pod}'\"\
          \"\"\n    elif len(node) > 0 and len(pid) > 0:\n        query = f\"\"\"\
          host_name='{node}' and pid='{pid}'\"\"\"\n    elif len(service) > 0:\n \
          \       query = f\"\"\"container_name='{service}'\"\"\"\n    elif len(containerId)\
          \ > 0:\n        query = f\"\"\"container_id='{containerId}'\"\"\"\n    elif\
          \ len(node) > 0:\n        query = f\"\"\"host_name='{node}'\"\"\"\n\n  \
          \  if len(sourceFrom) > 0:\n        if len(query) > 0:\n            query\
          \ += f\" and source='{sourceFrom}'\"\n        else:\n            query =\
          \ f\"\"\"source='{sourceFrom}'\"\"\"\n            \n    return {\n     \
          \   \"query\": query,\n    }"
        code_language: python3
        desc: ''
        outputs:
          query:
            children: null
            type: string
        selected: false
        title: è·å–æŸ¥è¯¢æ¡ä»¶
        type: code
        variables:
        - value_selector:
          - '1742807803325'
          - pod
          variable: pod
        - value_selector:
          - '1742807803325'
          - service
          variable: service
        - value_selector:
          - '1742807803325'
          - nodeName
          variable: node
        - value_selector:
          - '1742807803325'
          - pid
          variable: pid
        - value_selector:
          - '1742807803325'
          - containerId
          variable: containerId
        - value_selector:
          - '1742807803325'
          - sourceFrom
          variable: sourceFrom
      height: 54
      id: '1744878352649'
      position:
        x: 1854
        y: 812
      positionAbsolute:
        x: 1854
        y: 812
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: /models/qwen2.5-32B
          provider: langgenius/openai_api_compatible/openai_api_compatible
        prompt_template:
        - id: 615ece65-9193-4bad-a375-d51b67dbaafc
          role: system
          text: ä½ æ˜¯ä¸€ä½å¯è§‚æµ‹æ€§é¢†åŸŸæ™ºèƒ½åŠ©æ‰‹ï¼Œå¸®åŠ©ç”¨æˆ·åˆ†æè§£å†³é—®é¢˜ã€‚
        - id: cc52b45f-d678-4d55-98d1-7ed48f7b4091
          role: user
          text: '# ç›®çš„

            æ ¹æ®å¼‚å¸¸podï¼Œç»“åˆç›¸å…³æ—¥å¿—ï¼Œåˆ†æå‘Šè­¦{{#1742807803325.alertName#}}

            äº§ç”Ÿçš„åŸå› å’Œå¯¹{{#1742807803325.service#}}

            æˆ–{{#1742807803325.pod#}}

            çš„å½±å“ã€‚æœ€åç»“åˆæ—¥å¿—å’Œå¸¸è§æ’æŸ¥æ€è·¯ä¸ºç”¨æˆ·æå‡ºè§£å†³æ–¹æ¡ˆã€‚



            # æ•°æ®

            æ•°æ®åŒ…æ‹¬ï¼š

            1. å¯¹åº”æ—¶é—´å†…çš„erroræ—¥å¿—{{#1744901266309.logs#}}


            # åˆ†ææ€è·¯

            ç»“åˆå¼‚å¸¸podså’Œæ—¥å¿—ï¼Œæ‰¾åˆ°å‡ºé”™podså’Œå¯¹åº”çš„é”™è¯¯å†…å®¹ï¼Œåˆ†æé”™è¯¯åŸå› ã€‚å¦‚æœæ²¡æœ‰å¼‚å¸¸æ—¥å¿—åˆ™æç¤ºç”¨æˆ·ä¸»åŠ¨æŸ¥çœ‹ç›¸å…³æ—¶é—´å†…çš„æ—¥å¿—å†…å®¹ï¼Œå¹¶æé†’ç”¨æˆ·é…ç½®æ—¥å¿—è§£æè§„åˆ™ã€‚


            # æ³¨æ„äº‹é¡¹

            - æ—¶é—´å•ä½å‡ä¸ºå¾®ç§’


            # è¾“å‡ºå†…å®¹

            å‘Šè­¦{{#1742807803325.alertName#}}

            äº§ç”Ÿçš„åŸå› æ˜¯xxï¼Œå¯¹

            {{#1742807803325.pod#}}æˆ–{{#1742807803325.service#}}

            çš„å½±å“æ˜¯ï¼šå“ªäº›podså‡ºé”™ï¼Œå…·ä½“æ—¥å¿—ä¸ºxxã€‚


            è§£å†³æ–¹æ¡ˆï¼šxx'
        selected: false
        title: æ€»ç»“æ—¥å¿—é”™è¯¯
        type: llm
        variables: []
        vision:
          enabled: false
      height: 96
      id: '1744878372490'
      position:
        x: 2766
        y: 812
      positionAbsolute:
        x: 2766
        y: 812
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "import json\n\ndef main(data_json: str):\n    data = json.loads(data_json).get('data',\
          \ {}).get('list', [])\n\n    error_instances = []\n    for trace in data:\
          \ \n        if not trace.get(\"flags\", {}).get('is_error', False):\n  \
          \          continue\n\n        error_instances.append({\n            'endpoint':\
          \ trace.get('endpoint'),\n            'instance': trace.get('instanceId'),\n\
          \            'tid_key': trace.get('tid_key'),\n            'service': trace.get('service')\n\
          \        })\n    error_instances = error_instances[:30]\n    return {\n\
          \        'errorInstances': error_instances,\n    }\n"
        code_language: python3
        desc: ''
        outputs:
          errorInstances:
            children: null
            type: array[object]
        selected: false
        title: æå–æ•…éšœé“¾è·¯ç›¸å…³ç«¯ç‚¹
        type: code
        variables:
        - value_selector:
          - '1744878298576'
          - text
          variable: data_json
      height: 54
      id: '1744878389686'
      position:
        x: 1550
        y: 492
      positionAbsolute:
        x: 1550
        y: 492
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        is_team_authorization: true
        output_schema: null
        paramSchemas:
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: Query condition(clickhouse where clause).
            ja_JP: Query condition(clickhouse where clause).
            pt_BR: Query condition(clickhouse where clause).
            zh_Hans: æŸ¥è¯¢æ¡ä»¶ï¼ˆclickhouse whereå­å¥ï¼‰
          label:
            en_US: Query condition(clickhouse where clause).
            ja_JP: Query condition(clickhouse where clause).
            pt_BR: Query condition(clickhouse where clause).
            zh_Hans: æŸ¥è¯¢æ¡ä»¶ï¼ˆclickhouse whereå­å¥ï¼‰
          llm_description: Query condition(clickhouse where clause).
          max: null
          min: null
          name: query
          options: []
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: Start timestamp in microseconds
            ja_JP: Start timestamp in microseconds
            pt_BR: Start timestamp in microseconds
            zh_Hans: æŸ¥è¯¢å¼€å§‹æ—¶é—´ï¼ˆå¾®ç§’ï¼‰
          label:
            en_US: Start Time
            ja_JP: Start Time
            pt_BR: Start Time
            zh_Hans: å¼€å§‹æ—¶é—´
          llm_description: Microsecond timestamp for start time
          max: null
          min: null
          name: startTime
          options: []
          placeholder: null
          precision: null
          required: true
          scope: null
          template: null
          type: number
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: End timestamp in microseconds
            ja_JP: End timestamp in microseconds
            pt_BR: End timestamp in microseconds
            zh_Hans: æŸ¥è¯¢ç»“æŸæ—¶é—´ï¼ˆå¾®ç§’ï¼‰
          label:
            en_US: End Time
            ja_JP: End Time
            pt_BR: End Time
            zh_Hans: ç»“æŸæ—¶é—´
          llm_description: Microsecond timestamp for end time
          max: null
          min: null
          name: endTime
          options: []
          placeholder: null
          precision: null
          required: true
          scope: null
          template: null
          type: number
        params:
          endTime: ''
          query: ''
          startTime: ''
        provider_id: apo_select
        provider_name: apo_select
        provider_type: builtin
        selected: false
        title: æŸ¥è¯¢å…¨é‡æ—¥å¿—
        tool_configurations: {}
        tool_label: æŸ¥è¯¢å…¨é‡æ—¥å¿—
        tool_name: æŸ¥è¯¢å…¨é‡æ—¥å¿—
        tool_parameters:
          endTime:
            type: variable
            value:
            - '1741227526517'
            - endTime
          pageNum:
            type: constant
            value: 1
          pageSize:
            type: constant
            value: 999
          query:
            type: mixed
            value: '{{#17448784268890.query#}}'
          startTime:
            type: variable
            value:
            - '1741227526517'
            - startTime
        type: tool
      height: 54
      id: '17448784142480'
      position:
        x: 2158
        y: 492
      positionAbsolute:
        x: 2158
        y: 492
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "\ndef main(pod: str, service: str, node: str, pid: str, containerId:\
          \ str) -> dict:\n    query = ''\n    if len(containerId) > 0 and len(node)\
          \ > 0:\n        query = f\"\"\"container_id='{containerId}' and host_name='{node}'\"\
          \"\"\n    elif len(pod) > 0 and len(service) > 0:\n        query = f\"\"\
          \"k8s_pod_name='{pod}' and container_name='{service}'\"\"\"\n    elif len(pod)\
          \ > 0:\n        query = f\"\"\"k8s_pod_name='{pod}'\"\"\"\n    elif len(node)\
          \ > 0 and len(pid) > 0:\n        query = f\"\"\"host_name='{node}' and pid='{pid}'\"\
          \"\"\n    elif len(service) > 0:\n        query = f\"\"\"container_name='{service}'\"\
          \"\"\n    elif len(containerId) > 0:\n        query = f\"\"\"container_id='{containerId}'\"\
          \"\"\n\n    return {\n        \"query\": query,\n    }"
        code_language: python3
        desc: ''
        outputs:
          query:
            children: null
            type: string
        selected: false
        title: è·å–æŸ¥è¯¢æ¡ä»¶
        type: code
        variables:
        - value_selector:
          - '1742807803325'
          - pod
          variable: pod
        - value_selector:
          - '1742807803325'
          - service
          variable: service
        - value_selector:
          - '1742807803325'
          - nodeName
          variable: node
        - value_selector:
          - '1742807803325'
          - pid
          variable: pid
        - value_selector:
          - '1742807803325'
          - containerId
          variable: containerId
      height: 54
      id: '17448784268890'
      position:
        x: 1854
        y: 492
      positionAbsolute:
        x: 1854
        y: 492
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: /models/qwen2.5-32B
          provider: langgenius/openai_api_compatible/openai_api_compatible
        prompt_template:
        - id: 615ece65-9193-4bad-a375-d51b67dbaafc
          role: system
          text: ä½ æ˜¯ä¸€ä½å¯è§‚æµ‹æ€§é¢†åŸŸæ™ºèƒ½åŠ©æ‰‹ï¼Œå¸®åŠ©ç”¨æˆ·åˆ†æè§£å†³é—®é¢˜ã€‚
        - id: 1701b6b3-dcd0-4d8b-80cc-62a96aef9170
          role: user
          text: '# ç›®çš„

            æ ¹æ®å¼‚å¸¸podï¼Œç»“åˆç›¸å…³æ—¥å¿—ï¼Œåˆ†æå‘Šè­¦{{#1742807803325.alertName#}}

            äº§ç”Ÿçš„åŸå› å’Œå¯¹{{#1742807803325.pod#}}

            æˆ–{{#1742807803325.service#}}

            çš„å½±å“ã€‚æœ€åç»“åˆæ—¥å¿—å’Œå¸¸è§æ’æŸ¥æ€è·¯ä¸ºç”¨æˆ·æå‡ºè§£å†³æ–¹æ¡ˆã€‚



            # æ•°æ®

            æ•°æ®åŒ…æ‹¬ï¼š

            1. å¯¹åº”æ—¶é—´å†…çš„erroræ—¥å¿—{{#17449013347930.logs#}}


            2. å¯¹åº”æ—¶é—´æ®µå†…é“¾è·¯ç›¸å…³çš„30ä¸ªendpointsï¼Œserviceå’Œinstancesç»„åˆ{{#1744878389686.errorInstances#}}


            3. äº§ç”Ÿå‘Šè­¦çš„service{{#1742807803325.service#}}å’Œendpoint{{#1742807803325.endpoint#}}



            # åˆ†ææ€è·¯

            ç»“åˆå¼‚å¸¸podså’Œæ—¥å¿—ï¼Œæ‰¾åˆ°å‡ºé”™podså’Œå¯¹åº”çš„é”™è¯¯å†…å®¹ï¼Œåˆ†æé”™è¯¯åŸå› ã€‚å¦‚æœæ²¡æœ‰å¼‚å¸¸æ—¥å¿—åˆ™æç¤ºç”¨æˆ·ä¸»åŠ¨æŸ¥çœ‹ç›¸å…³æ—¶é—´å†…çš„æ—¥å¿—å†…å®¹ï¼Œå¹¶æé†’ç”¨æˆ·é…ç½®æ—¥å¿—è§£æè§„åˆ™ã€‚æœ€åå»é‡å¹¶ç»Ÿè®¡é”™è¯¯ç«¯ç‚¹ã€‚



            # æ³¨æ„äº‹é¡¹

            - æ—¶é—´å•ä½å‡ä¸ºå¾®ç§’


            # è¾“å‡ºå†…å®¹

            å‘Šè­¦{{#1742807803325.alertName#}}

            äº§ç”Ÿçš„åŸå› æ˜¯xxï¼Œå¯¹

            {{#1742807803325.service#}}æˆ–{{#1742807803325.pod#}}

            çš„å½±å“æ˜¯ï¼šå“ªäº›podså‡ºé”™ï¼Œå…·ä½“æ—¥å¿—ä¸ºxxã€‚å‡ºé”™çš„æœåŠ¡ç«¯ç‚¹ä¸ºxxã€‚


            è§£å†³æ–¹æ¡ˆï¼šxx'
        selected: false
        title: æ€»ç»“è¯·æ±‚é”™è¯¯
        type: llm
        variables: []
        vision:
          enabled: false
      height: 96
      id: '17448784398000'
      position:
        x: 2766
        y: 492
      positionAbsolute:
        x: 2766
        y: 492
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        output_type: string
        selected: false
        title: å˜é‡èšåˆå™¨
        type: variable-aggregator
        variables:
        - - '1744878372490'
          - text
        - - '17448784398000'
          - text
      height: 130
      id: '1744878466157'
      position:
        x: 3374
        y: 492
      positionAbsolute:
        x: 3374
        y: 492
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        outputs:
        - value_selector:
          - '1744878466157'
          - output
          variable: text
        - value_selector:
          - '1751602453263'
          - text
          variable: output
        - value_selector:
          - '1751004239868'
          - text
          variable: alertDirection
        selected: false
        title: ç»“æŸ
        type: end
      height: 142
      id: '1744878476249'
      position:
        x: 5806
        y: 836
      positionAbsolute:
        x: 5806
        y: 836
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "import re\nfrom typing import List\nimport json\n\nERROR_PATTERNS:\
          \ List[str] = [\n    r\"\\bERROR\\b\",\n    r\"\\bERR\\b\",\n    r\"\\bEXCEPTION\\\
          b\",\n    r\"\\bPANIC\\b\",\n    r\"\\bFAIL(?:ED)?\\b\",\n    r\"\\bWRONG\\\
          b\",\n    r\"\\bFATAL\\b\",\n    r\"\\b500\\b\",\n    r\"\\b5\\d{2}\\b\"\
          ,\n]\n\nERROR_REGEXES = [re.compile(pat, re.IGNORECASE) for pat in ERROR_PATTERNS]\n\
          \ndef is_error_log(line: str) -> bool:\n    if not isinstance(line, (str,\
          \ bytes)):\n        return False\n    for regex in ERROR_REGEXES:\n    \
          \    if regex.search(line):\n            return True\n    return False\n\
          \ndef main(data_json: str) -> dict:\n    logs = json.loads(data_json).get(\"\
          data\", {}).get(\"logContents\", {}).get(\"contents\", [])\n    \n    error_logs\
          \ = []\n    all_logs = []\n    \n    for log in logs or []:\n        content\
          \ = log.get(\"body\", \"\")\n        timestamp = log.get(\"timestamp\")\n\
          \        tags = log.get('tags', {})\n        \n        simplified_log =\
          \ {\n            \"body\": content,\n            \"timestamp\": timestamp,\n\
          \            \"tags\": tags\n        }\n        \n        all_logs.append(simplified_log)\n\
          \        if is_error_log(content):\n            error_logs.append(simplified_log)\n\
          \    \n    result_logs = error_logs if error_logs else all_logs[:100]\n\
          \    \n    MAX_LENGTH = 50000\n    result_logs_str = json.dumps({\"logs\"\
          : result_logs}, separators=(\",\", \":\"))\n    \n    while len(result_logs_str)\
          \ > MAX_LENGTH and len(result_logs) > 0:\n        remove_count = max(1,\
          \ len(result_logs) // 10)\n        result_logs = result_logs[:-remove_count]\n\
          \        result_logs_str = json.dumps({\"logs\": result_logs}, separators=(\"\
          ,\", \":\"))\n    \n    return {\"logs\": result_logs_str}"
        code_language: python3
        desc: ''
        outputs:
          logs:
            children: null
            type: string
        selected: false
        title: æå–é”™è¯¯æ—¥å¿—
        type: code
        variables:
        - value_selector:
          - '1744878296971'
          - text
          variable: data_json
      height: 54
      id: '1744901266309'
      position:
        x: 2462
        y: 812
      positionAbsolute:
        x: 2462
        y: 812
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "import re\nfrom typing import List\nimport json\n\nERROR_PATTERNS:\
          \ List[str] = [\n    r\"ERROR\",\n    r\"ERR\",\n    r\"EXCEPTION\",\n \
          \   r\"PANIC\",\n    r\"FAIL(?:ED)?\",\n    r\"WRONG\",\n    r\"FATAL\"\
          ,\n    r\"500\",\n    r\"5\\d{2}\",\n]\n\nERROR_REGEXES = [re.compile(pat,\
          \ re.IGNORECASE) for pat in ERROR_PATTERNS]\n\ndef is_error_log(line: str)\
          \ -> bool:\n    if not isinstance(line, (str, bytes)):\n        return False\n\
          \    for regex in ERROR_REGEXES:\n        if regex.search(line):\n     \
          \       return True\n    return False\n\ndef main(data_json: str) -> dict:\n\
          \    logs = json.loads(data_json).get(\"data\", {}).get(\"logContents\"\
          , {}).get(\"contents\", [])\n    \n    error_logs = []\n    all_logs = []\n\
          \    \n    for log in logs or []:\n        content = log.get(\"body\", \"\
          \")\n        timestamp = log.get(\"timestamp\")\n        tags = log.get('tags',\
          \ {})\n        \n        simplified_log = {\n            \"body\": content,\n\
          \            \"timestamp\": timestamp,\n            \"tags\": tags\n   \
          \     }\n        \n        all_logs.append(simplified_log)\n        if is_error_log(content):\n\
          \            error_logs.append(simplified_log)\n    \n    result_logs =\
          \ error_logs if error_logs else all_logs[:100]\n    \n    MAX_LENGTH = 50000\n\
          \    result_logs_str = json.dumps({\"logs\": result_logs}, separators=(\"\
          ,\", \":\"))\n    \n    while len(result_logs_str) > MAX_LENGTH and len(result_logs)\
          \ > 0:\n        remove_count = max(1, len(result_logs) // 10)\n        result_logs\
          \ = result_logs[:-remove_count]\n        result_logs_str = json.dumps({\"\
          logs\": result_logs}, separators=(\",\", \":\"))\n    \n    return {\"logs\"\
          : result_logs_str}"
        code_language: python3
        desc: ''
        outputs:
          logs:
            children: null
            type: string
        selected: false
        title: æå–é”™è¯¯æ—¥å¿—
        type: code
        variables:
        - value_selector:
          - '17448784142480'
          - text
          variable: data_json
      height: 54
      id: '17449013347930'
      position:
        x: 2462
        y: 492
      positionAbsolute:
        x: 2462
        y: 492
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        outputs:
        - value_selector:
          - '1745313576757'
          - output
          variable: output
        selected: false
        title: ç»“æŸ
        type: end
      height: 90
      id: '1745313574375'
      position:
        x: 1550
        y: 586
      positionAbsolute:
        x: 1550
        y: 586
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        selected: false
        template: æš‚ä¸æ”¯æŒçš„å‘Šè­¦ç±»å‹ï¼š{{ alertName }}
        title: ä¸æ”¯æŒçš„å‘Šè­¦ç±»å‹
        type: template-transform
        variables:
        - value_selector:
          - '1742807803325'
          - alertName
          variable: alertName
      height: 54
      id: '1745313576757'
      position:
        x: 1246
        y: 622
      positionAbsolute:
        x: 1246
        y: 622
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: qwen3:30b
          provider: langgenius/openai_api_compatible/openai_api_compatible
        prompt_template:
        - id: 8eba855d-6560-4b17-95ce-79dcdef46512
          role: system
          text: ä½ æ˜¯å¯è§‚æµ‹æ€§é¢†åŸŸçš„æ™ºèƒ½åŠ©æ‰‹ï¼ŒååŠ©ç”¨æˆ·åˆ†æè§£å†³é—®é¢˜ã€‚
        - id: 6879b5be-4f99-4107-af3a-e4f5d5d26cd0
          role: user
          text: 'æ­¤å‘Šè­¦äº‹ä»¶{{#1742807803325.alertName#}}å±äºeventç±»å‹ï¼Œ

            å‘Šè­¦ä¿¡æ¯

            {{#1741227526517.params#}}

            è¯·ç»™å‡ºä¸€äº›å»ºè®®'
        selected: true
        title: LLM 3
        type: llm
        variables: []
        vision:
          enabled: false
      height: 90
      id: '1745391138767'
      position:
        x: 1246
        y: 731
      positionAbsolute:
        x: 1246
        y: 731
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        outputs:
        - value_selector:
          - '1745391138767'
          - text
          variable: text
        selected: false
        title: ç»“æŸ
        type: end
      height: 90
      id: '1745391142578'
      position:
        x: 1550
        y: 716
      positionAbsolute:
        x: 1550
        y: 716
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        is_team_authorization: true
        output_schema: null
        paramSchemas:
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: reportType
            ja_JP: reportType
            pt_BR: reportType
            zh_Hans: æŠ¥å‘Šç±»å‹
          label:
            en_US: reportType
            ja_JP: reportType
            pt_BR: reportType
            zh_Hans: æŠ¥å‘Šç±»å‹
          llm_description: alert report type
          max: null
          min: null
          name: reportType
          options: []
          placeholder: null
          precision: null
          required: true
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: reportType
            ja_JP: reportType
            pt_BR: tags
            zh_Hans: æŠ¥å‘Šæ ‡ç­¾ï¼ˆç”¨äºæ£€ç´¢ï¼‰
          label:
            en_US: tags
            ja_JP: tags
            pt_BR: tags
            zh_Hans: æŠ¥å‘Šæ ‡ç­¾ï¼ˆç”¨äºæ£€ç´¢ï¼‰
          llm_description: alert report tags
          max: null
          min: null
          name: tags
          options: []
          placeholder: null
          precision: null
          required: true
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: overview
            ja_JP: overview
            pt_BR: overview
            zh_Hans: å‘Šè­¦äº‹ä»¶æ€»è§ˆ
          label:
            en_US: overview
            ja_JP: overview
            pt_BR: overview
            zh_Hans: å‘Šè­¦äº‹ä»¶æ€»è§ˆ
          llm_description: overview
          max: null
          min: null
          name: overview
          options: []
          placeholder: null
          precision: null
          required: true
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: topology
            ja_JP: topology
            pt_BR: topology
            zh_Hans: æŠ¥å‘Šç±»å‹
          label:
            en_US: topology
            ja_JP: topology
            pt_BR: topology
            zh_Hans: æ‹“æ‰‘æ•°æ®
          llm_description: topology data
          max: null
          min: null
          name: topology
          options: []
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: rootCauseAnalysis
            ja_JP: rootCauseAnalysis
            pt_BR: rootCauseAnalysis
            zh_Hans: æ ¹å› åˆ†æç»“è®º
          label:
            en_US: rootCauseAnalysis
            ja_JP: rootCauseAnalysis
            pt_BR: rootCauseAnalysis
            zh_Hans: æ ¹å› åˆ†æç»“è®º
          llm_description: rootCauseAnalysis
          max: null
          min: null
          name: rootCauseAnalysis
          options: []
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: suggest
            ja_JP: suggest
            pt_BR: suggest
            zh_Hans: å¯è¡ŒåŠ¨æ–¹å‘å»ºè®®
          label:
            en_US: suggest
            ja_JP: suggest
            pt_BR: suggest
            zh_Hans: å¯è¡ŒåŠ¨æ–¹å‘å»ºè®®
          llm_description: suggest
          max: null
          min: null
          name: suggest
          options: []
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: evidence
            ja_JP: evidence
            pt_BR: evidence
            zh_Hans: æ ¹å› åˆ†æç»“è®º
          label:
            en_US: evidence
            ja_JP: evidence
            pt_BR: evidence
            zh_Hans: éªŒè¯æ•°æ®
          llm_description: evidence
          max: null
          min: null
          name: evidence
          options: []
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: string
        params:
          evidence: ''
          overview: ''
          reportType: ''
          rootCauseAnalysis: ''
          suggest: ''
          tags: ''
          topology: ''
        provider_id: apo_analysis
        provider_name: apo_analysis
        provider_type: builtin
        selected: false
        title: ç”Ÿæˆå‘Šè­¦åˆ†ææŠ¥å‘Š
        tool_configurations: {}
        tool_label: ç”Ÿæˆå‘Šè­¦åˆ†ææŠ¥å‘Š
        tool_name: Generate alert analysis report
        tool_parameters:
          evidence:
            type: mixed
            value: '{{#1750843294839.result#}}'
          overview:
            type: mixed
            value: '{{#1750840042580.result#}}'
          reportType:
            type: mixed
            value: error
          rootCauseAnalysis:
            type: mixed
            value: '{{#1750843945254.result#}}'
          suggest:
            type: mixed
            value: '{{#1750843922551.result#}}'
          tags:
            type: mixed
            value: '{{#1750839702220.result#}}'
          topology:
            type: mixed
            value: '{{#1750941439700.result#}}'
        type: tool
      height: 54
      id: '1750839691646'
      position:
        x: 4894
        y: 836
      positionAbsolute:
        x: 4894
        y: 836
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "\n\ndef main(alertEventId: str) -> dict:\n    data = {\n        \"\
          alertEventId\": alertEventId\n    }\n    return {\n        \"result\": json.dumps(data),\n\
          \    }\n"
        code_language: python3
        desc: ''
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: æŠ¥å‘Šæ ‡ç­¾
        type: code
        variables:
        - value_selector:
          - '1742807803325'
          - alertEventId
          variable: alertEventId
      height: 54
      id: '1750839702220'
      position:
        x: 4590
        y: 492
      positionAbsolute:
        x: 4590
        y: 492
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "\n\ndef main(timestamp: int, reason: str, pod: str, node: str, pid:\
          \ str, containerId: str, service: str, detail: str) -> dict:\n    data =\
          \ {\n        \"timestamp\": timestamp,\n        \"detail\": detail,\n  \
          \      \"reason\": reason,\n        \"tags\": {\n            \"service\"\
          : service,\n            \"pod\": pod,\n            \"nodeName\": node,\n\
          \            \"pid\": pid,\n            \"containerId\": containerId\n \
          \       }\n    }\n    return {\n        \"result\": json.dumps(data),\n\
          \    }"
        code_language: python3
        desc: ''
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: æŠ¥å‘Šæ€»è§ˆ
        type: code
        variables:
        - value_selector:
          - '1741227526517'
          - endTime
          variable: timestamp
        - value_selector:
          - '1750840340832'
          - text
          variable: reason
        - value_selector:
          - '1742807803325'
          - pod
          variable: pod
        - value_selector:
          - '1741227526517'
          - nodeName
          variable: node
        - value_selector:
          - '1742807803325'
          - pid
          variable: pid
        - value_selector:
          - '1742807803325'
          - containerId
          variable: containerId
        - value_selector:
          - '1742807803325'
          - service
          variable: service
        - value_selector:
          - '1750987639392'
          - text
          variable: detail
      height: 54
      id: '1750840042580'
      position:
        x: 4590
        y: 700
      positionAbsolute:
        x: 4590
        y: 700
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: /models/qwen2.5-32B
          provider: langgenius/openai_api_compatible/openai_api_compatible
        prompt_template:
        - id: d21add02-97db-4fa3-a6e8-d4387617ce2a
          role: system
          text: ä½ æ˜¯ä¸€ä¸ªå¯è§‚æµ‹æ€§é¢†åŸŸçš„æ™ºèƒ½åŠ©æ‰‹ï¼Œå¸®åŠ©ç”¨æˆ·è§£å†³é—®é¢˜
        - id: 4ca361b5-08c7-461e-b239-648db7bd6815
          role: user
          text: "#ç›®çš„\næ ¹æ®åº”ç”¨çš„ç»“è®ºç”Ÿæˆæ ¹å› æ–¹å‘çš„ç»“è®º\n#ç»“è®ºæ•°æ®\n{{#1744878466157.output#}}\n# æ—¶é—´\n\
            {{#1741227526517.endTime#}}\n#æ ¼å¼æ¨¡ç‰ˆå‚è€ƒ\nå‘Šè­¦æŠ¥äº‹ä»¶ç»“è®º \n**äº‹ä»¶æ¦‚è¿°**ï¼š\n\n\U0001F6A8\
            \ æ—¥å¿—é”™è¯¯ç‡å‡é«˜ï¼š15%çš„è¯·æ±‚è¶…è¿‡70æ¯«ç§’ï¼ŒæŒç»­5åˆ†é’Ÿ\n\U0001F4CA å¼‚å¸¸æ—¥å¿—ï¼šå…±128ä¸ªï¼Œ90%å¼‚å¸¸\n**é—®é¢˜åˆ†æ**\n\n\
            \U0001F552 æ—¥å¿—æ˜¾ç¤ºxxx\n \U0001F310 æ˜¾ç¤ºxxxå¯èƒ½å­˜åœ¨xxxx\n**è§£å†³æªæ–½**ï¼š\n\n\U0001F6E0\
            ï¸ æ‰§è¡Œxxx\n\U0001F527 æ£€æŸ¥xxx\n**æ—¥å¿—æ•°æ®**ï¼š\n\nâ±ï¸ xxå¼‚å¸¸\n#è¾“å‡ºæ ¼å¼\næ ¼å¼å‚è€ƒæ¨¡ç‰ˆï¼Œæ³¨æ„æ¢è¡Œå’Œç©ºæ ¼ï¼Œç¡®ä¿æ–‡æœ¬ç¾è§‚è¾“å‡ºï¼Œç®€å•æ˜“æ‡‚(ä½¿ç”¨MarkDownæ ¼å¼çš„æ–‡æœ¬)ï¼Œä¸”ä¸è¦æœ‰å…¶ä»–è¾“å‡º"
        selected: false
        title: æ ¼å¼åŒ–ç»“è®º
        type: llm
        variables: []
        vision:
          enabled: false
      height: 96
      id: '1750840340832'
      position:
        x: 4286
        y: 700
      positionAbsolute:
        x: 4286
        y: 700
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "\n\ndef main(logs: str, log_text: str) -> dict:\n    logs_raw = json.loads(logs)\n\
          \    logs_data = {\n        \"type\": \"log\",\n        \"name\": \"åº”ç”¨æ—¥å¿—\"\
          ,\n        \"description\": log_text,\n        \"data\": logs_raw.get(\"\
          logs\", [])\n    }\n\n    return {\n        \"result\": json.dumps({\n \
          \           \"evidence\": [logs_data]\n        }),\n    }\n"
        code_language: python3
        desc: ''
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: æ±‡æ€»éªŒè¯æ•°æ®
        type: code
        variables:
        - value_selector:
          - '1750844540721'
          - output
          variable: logs
        - value_selector:
          - '1751251291730'
          - text
          variable: log_text
      height: 54
      id: '1750843294839'
      position:
        x: 4590
        y: 836
      positionAbsolute:
        x: 4590
        y: 836
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "import re\ndef main(raw_data: str) -> dict:\n    pattern = r'```json\\\
          n(.*?)\\n```'\n    match = re.search(pattern, raw_data, re.DOTALL)\n\n \
          \   json_str = match.group(1)\n    rootcause = json.loads(json_str)\n  \
          \  return {\n        \"result\": json.dumps(rootcause),\n    }"
        code_language: python3
        desc: ''
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: å¯è¡ŒåŠ¨æ–¹å‘å»ºè®®
        type: code
        variables:
        - value_selector:
          - '1750846397041'
          - text
          variable: raw_data
      height: 54
      id: '1750843922551'
      position:
        x: 4590
        y: 972
      positionAbsolute:
        x: 4590
        y: 972
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "import re\ndef main(raw_data: str) -> dict:\n    pattern = r'```json\\\
          n(.*?)\\n```'\n    match = re.search(pattern, raw_data, re.DOTALL)\n\n \
          \   json_str = match.group(1)\n    rootcause = json.loads(json_str)\n  \
          \  return {\n        \"result\": json.dumps(rootcause),\n    }"
        code_language: python3
        desc: ''
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: æ ¹å› æ–¹å‘
        type: code
        variables:
        - value_selector:
          - '1750846407202'
          - text
          variable: raw_data
      height: 54
      id: '1750843945254'
      position:
        x: 4590
        y: 1108
      positionAbsolute:
        x: 4590
        y: 1108
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        output_type: string
        selected: false
        title: èšåˆæŸ¥è¯¢æ—¥å¿—
        type: variable-aggregator
        variables:
        - - '1744901266309'
          - logs
        - - '17449013347930'
          - logs
      height: 130
      id: '1750844540721'
      position:
        x: 3070
        y: 492
      positionAbsolute:
        x: 3070
        y: 492
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: /models/qwen2.5-32B
          provider: langgenius/openai_api_compatible/openai_api_compatible
        prompt_template:
        - id: 7694ae43-c744-4e62-9a51-fb4b8d8fe597
          role: system
          text: ä½ æ˜¯ä¸€ä¸ªå¯è§‚æµ‹æ€§é¢†åŸŸçš„æ™ºèƒ½åŠ©æ‰‹
        - id: eaa0bed8-46a2-4c25-aca9-83d0f1105263
          role: user
          text: "#ç›®çš„\nç”Ÿæˆå»ºè®®ç”¨æˆ·çš„è¡ŒåŠ¨å»ºè®®\nå¦‚æ‰§è¡Œå‘½ä»¤ï¼Œæˆ–è€…æ‰¾xxxæ’é™¤é—®é¢˜\n#ç»“è®ºæ•°æ®\n{{#1744878466157.output#}}\n\
            \n\n#æ ¼å¼æ¨¡ç‰ˆ\n```json\n{\"suggest\": [\n        {\n            \"action\"\
            : \"Add index to payment transaction table.\",\n            \"level\"\
            : \"high\"\n        },\n        {\n            \"action\": \"Scale up\
            \ database node CPU resources.\",\n            \"level\": \"medium\"\n\
            \        }\n    ] }\n```\n#è¾“å‡ºæ ¼å¼\njsonæ ¼å¼æ•°æ®ï¼Œæ ¼å¼å‚æ•°æ¨¡ç‰ˆï¼Œä¸è¦æœ‰å…¶ä»–è¾“å‡º"
        selected: false
        title: å¯è¡ŒåŠ¨æ–¹å‘å»ºè®®
        type: llm
        variables: []
        vision:
          enabled: false
      height: 96
      id: '1750846397041'
      position:
        x: 4286
        y: 972
      positionAbsolute:
        x: 4286
        y: 972
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: /models/qwen2.5-32B
          provider: langgenius/openai_api_compatible/openai_api_compatible
        prompt_template:
        - id: 0e0b95f4-141c-413e-8a29-1b17b745495f
          role: system
          text: ä½ æ˜¯ä¸€ä¸ªå¯è§‚æµ‹æ€§é¢†åŸŸçš„æ™ºèƒ½åŠ©æ‰‹
        - id: 954478ee-4fa8-4750-9abf-14abf2e75271
          role: user
          text: "#ç›®çš„\næ ¹æ®åº”ç”¨çš„æ—¥å¿—ç»“è®ºç”Ÿæˆæ—¥å¿—æ ¹å› æ–¹å‘çš„ç»“è®º\n#ç»“è®ºæ•°æ®\n{{#1744878466157.output#}}\n# æ³¨æ„\n\
            typeä¸ºæ•…éšœæ–¹å‘\n1ç¬¬ä¸‰æ–¹ä¾èµ–ï¼ˆthirdpartyï¼‰ï¼Œé…ç½®é—®é¢˜(config)ï¼Œä»£ç å¼‚å¸¸(code)ï¼Œä¸‹æ¸¸æœåŠ¡é”™è¯¯(downstream)ï¼Œç³»ç»Ÿèµ„æºå¼‚å¸¸(system)\n\
            æ¯ä¸ªæ–¹å‘ç›´ç»™ä¸€ä¸ªç»“è®ºå³å¯ï¼Œä¸è¦å‡ºç°é‡å¤\nä¸»è¦æ ¹å› æ–¹å‘å¿…é¡»å’Œmajorç»“è®ºä¿æŒä¸€è‡´ï¼Œä¸è¦ä¸ç»Ÿä¸€\n2ä¸”å¿…é¡»ç»™ä¸€ä¸ªæœ‰é—®é¢˜çš„æ–¹å‘(levelä¸ºmajor)\n\
            3 åˆ—è¡¨å¿…é¡»æŒ‰ç…§ç­‰çº§æ’åºlevelä»é«˜åˆ°ä½ç»´ï¼ˆmajor,minor,normalï¼‰\n4 causeå†…å®¹åªèƒ½ä¸ºç¬¬ä¸‰æ–¹ä¾èµ–é”™è¯¯ï¼Œé…ç½®é—®é¢˜ï¼Œä»£ç å¼‚å¸¸ï¼Œä¸‹æ¸¸æœåŠ¡è°ƒç”¨é”™è¯¯ï¼Œç³»ç»Ÿèµ„æº\n\
            #æ ¼å¼æ¨¡ç‰ˆ\n```json\n{\n        \"cause\": \"ä¸»è¦åŸæ ¹å› æ–¹å‘\",\n        \"other\"\
            : [\n            {\n                \"reason\": \"\",\n              \
            \  \"type\": \"thirdparty\",\n                \"level\": \"major/minor/normal\"\
            \n            },\n            {\n                \"reason\": \"\",\n \
            \               \"type\": \"code\",\n                \"level\": \"minor\"\
            \n            },\n            {\n                \"reason\": \"\",\n \
            \               \"type\": \"config\",\n                \"level\": \"normal\"\
            \n            },\n            {\n                \"reason\": \"\",\n \
            \               \"type\": \"downstream\",\n                \"level\":\
            \ \"normal\"\n            },\n            {\n                \"reason\"\
            : \"\",\n                \"type\": \"system\",\n                \"level\"\
            : \"normal\"\n            }\n        ]\n    }\n```\n#è¾“å‡ºæ ¼å¼\ntypeåªèƒ½ä¸ºç¬¬ä¸‰æ–¹ä¾èµ–ï¼ˆthirdpartyï¼‰ï¼Œé…ç½®é—®é¢˜(config)ï¼Œä»£ç å¼‚å¸¸(code)ï¼Œä¸‹æ¸¸æœåŠ¡é”™è¯¯(downstream)ï¼Œç³»ç»Ÿèµ„æºå¼‚å¸¸(system)è¿™å‡ ç§ï¼Œä¸è¦æœ‰å…¶ä»–å†…å®¹\n\
            jsonæ ¼å¼æ•°æ®ï¼Œæ ¼å¼å‚æ•°æ¨¡ç‰ˆï¼Œä¸è¦æœ‰å…¶ä»–è¾“å‡º"
        selected: false
        title: æ ¹å› æ–¹å‘ç»“è®º
        type: llm
        variables: []
        vision:
          enabled: false
      height: 96
      id: '1750846407202'
      position:
        x: 4286
        y: 1108
      positionAbsolute:
        x: 4286
        y: 1108
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "import requests\nimport json\ndef get_topology(service, cluster, start_time,\
          \ end_time) -> str:\n        params = {\n          'service': service,\n\
          \          'cluster': cluster,\n          'startTime': start_time,\n   \
          \       'endTime': end_time,\n          }\n        resp = requests.get(\"\
          http://apo-backend-svc:8080\"+ '/api/dataplane/topology', params=params)\n\
          \        res = {}\n\n\n        query_params = {\n                    'startTime':\
          \ start_time,\n                    'endTime': end_time,\n              \
          \      'service': service\n        }\n        response = requests.get(\"\
          http://apo-backend-svc:8080\"+ '/api/dataplane/redcharts', params=query_params)\n\
          \        metrics = {}\n        if response.status_code == 200 and response.json()['msg']\
          \ == '':\n            metrics['latency'] = response.json()['results'][0]['timeseries'][0]['chart']\n\
          \            metrics['errorRate'] = response.json()['results'][1]['timeseries'][0]['chart']\n\
          \            metrics['tps'] = response.json()['results'][2]['timeseries'][0]['chart']\n\
          \        res['current'] = {\n            \"service\": service,\n       \
          \     \"description\": \"\",\n            \"metrics\": metrics,\n      \
          \  }\n\n        if resp.status_code == 200 and resp.json()['msg'] == \"\"\
          :\n            list = resp.json()\n            result = []\n           \
          \ for item in list['results'] or []:\n                if item[\"name\"]\
          \ == service:\n                    result = item\n\n            parents\
          \ = []\n            for p_svc in result['parents']:\n                query_params\
          \ = {\n                    'startTime': start_time,\n                  \
          \  'endTime': end_time,\n                    'service': p_svc\n        \
          \        }\n                response = requests.get(\"http://apo-backend-svc:8080\"\
          + '/api/dataplane/redcharts', params=query_params)\n                if response.status_code\
          \ != 200:\n                    continue\n                metrics = {}\n\
          \                metrics['latency'] = response.json()['results'][0]['timeseries'][0]['chart']\n\
          \                metrics['errorRate'] = response.json()['results'][1]['timeseries'][0]['chart']\n\
          \                metrics['tps'] = response.json()['results'][2]['timeseries'][0]['chart']\n\
          \                parents.append({\n                    'service': p_svc,\n\
          \                    'description': \"\",\n                    'metrics':\
          \ metrics,\n                })\n            \n            children = []\n\
          \            for c_svc in result['children']:\n                query_params\
          \ = {\n                    'startTime': start_time,\n                  \
          \  'endTime': end_time,\n                    'service': c_svc\n        \
          \        }\n                response = requests.get(\"http://apo-backend-svc:8080\"\
          + '/api/dataplane/redcharts', params=query_params)\n                if response.status_code\
          \ != 200 or response.json()['msg'] != '':\n                    continue\n\
          \                metrics = {}\n                metrics['latency'] = response.json()['results'][0]['timeseries'][0]['chart']\n\
          \                metrics['errorRate'] = response.json()['results'][1]['timeseries'][0]['chart']\n\
          \                metrics['tps'] = response.json()['results'][2]['timeseries'][0]['chart']\n\
          \                children.append({\n                    'service': c_svc,\n\
          \                    'description': \"\",\n                    'metrics':\
          \ metrics,\n                })\n            \n            res['children']\
          \ = children\n            res['parents'] = parents\n            return json.dumps(res)\n\
          \n\ndef main(service: str, startTime: int, endTime: int) -> dict:\n    rc\
          \ = get_topology(service, \"\", startTime, endTime)\n    if rc == None:\n\
          \        rc = \"{}\"\n    return {\n        \"result\": rc,\n    }"
        code_language: python3
        desc: ''
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: è·å–æ‹“æ‰‘
        type: code
        variables:
        - value_selector:
          - '1742807803325'
          - service
          variable: service
        - value_selector:
          - '1741227526517'
          - startTime
          variable: startTime
        - value_selector:
          - '1741227526517'
          - endTime
          variable: endTime
      height: 54
      id: '1750941439700'
      position:
        x: 4590
        y: 1202
      positionAbsolute:
        x: 4590
        y: 1202
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: /models/qwen2.5-32B
          provider: langgenius/openai_api_compatible/openai_api_compatible
        prompt_template:
        - id: 45ec55b5-ae91-45b8-989c-83f81cee1712
          role: system
          text: ä½ æ˜¯ä¸€ä¸ªå¯è§‚æµ‹æ€§é¢†åŸŸçš„æ™ºèƒ½åŠ©æ‰‹ï¼Œå¸®åŠ©ç”¨æˆ·è§£å†³é—®é¢˜
        - id: 2832e05f-6966-49d9-9697-77bde92736a9
          role: user
          text: "#ç›®çš„\næ ¹æ®åº”ç”¨çš„ç»“è®ºç”Ÿæˆå½“å‰æƒ…å†µçš„æè¿°\nä½¿ç”¨ç»“è®ºå†…çš„æ•°æ®ï¼Œå›ç­”ç®€æ´æ˜“æ‡‚\n#ç»“è®ºæ•°æ®\n{{#1744878466157.output#}}\n\
            # æ—¶é—´\n{{#1741227526517.endTime#}}\n#æ ¼å¼æ¨¡ç‰ˆå‚è€ƒ\nå‘Šè­¦æŠ¥äº‹ä»¶ç»“è®º \n**äº‹ä»¶æ¦‚è¿°**ï¼š\nå½“å‰å‘Šè­¦äº‹ä»¶ä¸ºXXXX\
            \ (ç®€æ´ï¼Œä¸è¦æœ‰å…¶ä»–å†…å®¹)\n**é—®é¢˜åˆ†æ**\nåˆæ­¥åˆ†ææ˜¯XXXæ–¹å‘ï¼ˆé€šè¿‡æ—¥å¿—å†…å®¹æ€»ç»“ï¼‰ï¼Œä¸è¦æœ‰å…¶ä»–å†…å®¹ï¼Œç»™å‡ºæ–¹å‘å³å¯\n**è§£å†³æªæ–½**ï¼š\n\
            - æ‰§è¡ŒXXXXå‘½ä»¤ï¼ˆå¿…é¡»å’Œæ•…éšœæ–¹å‘æœ‰å…³ï¼‰\n\n#è¾“å‡ºæ ¼å¼\næ ¼å¼å‚è€ƒæ¨¡ç‰ˆï¼Œæ³¨æ„æ¢è¡Œå’Œç©ºæ ¼ï¼Œç¡®ä¿æ–‡æœ¬ç¾è§‚è¾“å‡ºï¼Œç®€å•æ˜“æ‡‚(ä½¿ç”¨MarkDownæ ¼å¼çš„æ–‡æœ¬)ï¼Œä¸”ä¸è¦æœ‰å…¶ä»–è¾“å‡º"
        selected: false
        title: æ€»ç»“
        type: llm
        variables: []
        vision:
          enabled: false
      height: 96
      id: '1750987639392'
      position:
        x: 3982
        y: 700
      positionAbsolute:
        x: 3982
        y: 700
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: /models/qwen2.5-32B
          provider: langgenius/openai_api_compatible/openai_api_compatible
        prompt_template:
        - id: d33542e3-ac5c-48f1-970b-fa7ab0ffd0ef
          role: system
          text: ''
        - id: a070588b-7b1e-453e-8994-1e1bb6b4593c
          role: user
          text: '#ç›®çš„

            ä»æ•…éšœç»“è®ºä¸­æå–æ•…éšœæ–¹å‘

            # æ³¨æ„

            æ ¹æ®ç»“è®ºçš„å†…å®¹åˆ’åˆ†æ•…éšœæ–¹å‘

            1 å¦‚æœç½‘ç»œé“¾è·¯rttæ­£å¸¸ï¼Œç½‘ç»œæ–¹å‘ç»™å‡ºä¸‹æ¸¸ä¾èµ–é—®é¢˜

            2 æ—¥å¿—å‘Šè­¦ç»™å‡ºæ—¥å¿—é”™è¯¯

            3 åŸºç¡€è®¾æ–½å‘Šè­¦ï¼Œç»™å‡ºèµ„æºé—®é¢˜

            #ç»“è®ºæ•°æ®

            {{#1744878466157.output#}}

            #è¾“å‡ºå†…å®¹

            æ•…éšœæ–¹å‘ï¼Œåªè¾“å‡ºå››ä¸ªå­—å°±å¥½ ï¼ˆå¦‚ç½‘ç»œæ–¹å‘ï¼Œä¸‹æ¸¸ä¾èµ–é—®é¢˜ï¼Œcpuæ–¹å‘ï¼Œ æ—¥å¿—é”™è¯¯ç­‰ï¼‰'
        selected: false
        title: LLM 8
        type: llm
        variables: []
        vision:
          enabled: false
      height: 96
      id: '1751004239868'
      position:
        x: 5502
        y: 836
      positionAbsolute:
        x: 5502
        y: 836
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: /models/qwen2.5-32B
          provider: langgenius/openai_api_compatible/openai_api_compatible
        prompt_template:
        - role: system
          text: ä½ æ˜¯ä¸€ä¸ªå¯è§‚æµ‹æ€§é¢†åŸŸæ™ºèƒ½åŠ©æ‰‹ï¼Œå¸®åŠ©ç”¨æˆ·è§£å†³é—®é¢˜
        - role: user
          text: '# ç›®çš„

            è¾“å‡ºå½“å‰æ—¥å¿—æ•°æ®çš„æƒ…å†µï¼Œè¾“å‡ºå­—æ•°100å·¦å³ï¼Œå°½é‡ç®€æ´åäº†

            # æ—¥å¿—æ•°æ®

            {{#1750844540721.output#}}

            #è¾“å‡º

            ä»æ—¥å¿—ä¸­å¯ä»¥çœ‹å‡ºxxxx'
        selected: false
        title: æ—¥å¿—æ€»ç»“
        type: llm
        variables: []
        vision:
          enabled: false
      height: 96
      id: '1751251291730'
      position:
        x: 4286
        y: 836
      positionAbsolute:
        x: 4286
        y: 836
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        is_team_authorization: true
        output_schema: null
        paramSchemas:
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: alertEventId
            ja_JP: alertEventId
            pt_BR: alertEventId
            zh_Hans: æŠ¥å‘Šç±»å‹
          label:
            en_US: alertEventId
            ja_JP: alertEventId
            pt_BR: alertEventId
            zh_Hans: å‘Šè­¦äº‹ä»¶ID
          llm_description: alertEventId
          max: null
          min: null
          name: alertEventId
          options: []
          placeholder: null
          precision: null
          required: true
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: reportText
            ja_JP: reportText
            pt_BR: reportText
            zh_Hans: æŠ¥å‘Šç®€è¦æ–‡æœ¬
          label:
            en_US: reportText
            ja_JP: reportText
            pt_BR: reportText
            zh_Hans: æŠ¥å‘Šç®€è¦æ–‡æœ¬
          llm_description: reportText
          max: null
          min: null
          name: reportText
          options: []
          placeholder: null
          precision: null
          required: true
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: frontPrefix
            ja_JP: frontPrefix
            pt_BR: frontPrefix
            zh_Hans: æŠ¥å‘Šè®¿é—®åœ°å€
          label:
            en_US: frontPrefix
            ja_JP: frontPrefix
            pt_BR: frontPrefix
            zh_Hans: æŠ¥å‘Šè®¿é—®åœ°å€
          llm_description: frontPrefix
          max: null
          min: null
          name: frontPrefix
          options: []
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: Start timestamp in microseconds
            ja_JP: Start timestamp in microseconds
            pt_BR: Start timestamp in microseconds
            zh_Hans: æŸ¥è¯¢å¼€å§‹æ—¶é—´ï¼ˆå¾®ç§’ï¼‰
          label:
            en_US: Start Time
            ja_JP: Start Time
            pt_BR: Start Time
            zh_Hans: å¼€å§‹æ—¶é—´
          llm_description: Microsecond timestamp for start time
          max: null
          min: null
          name: startTime
          options: []
          placeholder: null
          precision: null
          required: true
          scope: null
          template: null
          type: number
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: End timestamp in microseconds
            ja_JP: End timestamp in microseconds
            pt_BR: End timestamp in microseconds
            zh_Hans: æŸ¥è¯¢ç»“æŸæ—¶é—´ï¼ˆå¾®ç§’ï¼‰
          label:
            en_US: End Time
            ja_JP: End Time
            pt_BR: End Time
            zh_Hans: ç»“æŸæ—¶é—´
          llm_description: Microsecond timestamp for end time
          max: null
          min: null
          name: endTime
          options: []
          placeholder: null
          precision: null
          required: true
          scope: null
          template: null
          type: number
        params:
          alertEventId: ''
          endTime: ''
          frontPrefix: ''
          reportText: ''
          startTime: ''
        provider_id: apo_analysis
        provider_name: apo_analysis
        provider_type: builtin
        selected: false
        title: è·å–å‘Šè­¦åˆ†ææŠ¥å‘Šé“¾æ¥
        tool_configurations: {}
        tool_label: è·å–å‘Šè­¦åˆ†ææŠ¥å‘Šé“¾æ¥
        tool_name: get alert report url
        tool_parameters:
          alertEventId:
            type: mixed
            value: '{{#1742807803325.alertEventId#}}'
          endTime:
            type: variable
            value:
            - '1741227526517'
            - endTime
          reportText:
            type: mixed
            value: å½“å‰åº”ç”¨æ—¥å¿—é”™è¯¯æ•°å‡é«˜\nè¯¦ç»†æŠ¥å‘Šå†…å®¹\n
          startTime:
            type: variable
            value:
            - '1741227526517'
            - startTime
        type: tool
      height: 54
      id: '1751602453263'
      position:
        x: 5198
        y: 836
      positionAbsolute:
        x: 5198
        y: 836
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: is
            id: cbd77e4f-1f53-4d83-b9fe-413de4db0078
            value: ce
            varType: string
            variable_selector:
            - '1741227526517'
            - edition
          id: 'true'
          logical_operator: and
        desc: ''
        selected: false
        title: æ¡ä»¶åˆ†æ”¯ 2
        type: if-else
      height: 126
      id: '1751602618703'
      position:
        x: 3678
        y: 492
      positionAbsolute:
        x: 3678
        y: 492
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        outputs:
        - value_selector:
          - '1744878466157'
          - output
          variable: text
        selected: false
        title: ç»“æŸ 5
        type: end
      height: 90
      id: '1751602687916'
      position:
        x: 3982
        y: 570
      positionAbsolute:
        x: 3982
        y: 570
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    viewport:
      x: 47.03146648242307
      y: 94.5672153955509
      zoom: 0.3941309919597938
